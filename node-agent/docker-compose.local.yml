version: '3.8'

# Вариант docker-compose для локального тестирования
# Использование: docker-compose -f docker-compose.local.yml up

services:
  node-agent:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: remnawave-node-agent-local
    restart: unless-stopped
    
    env_file:
      - .env
    
    # Для локального тестирования монтируем тестовые логи
    volumes:
      - ./test-logs:/var/log/remnanode:ro
    
    # Подключаемся к Admin Bot через host.docker.internal
    # В .env должно быть: AGENT_COLLECTOR_URL=http://host.docker.internal:8000
    extra_hosts:
      - "host.docker.internal:host-gateway"
    
    # Логирование
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
